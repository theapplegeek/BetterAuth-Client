<div class="app-modal-panel max-w-2xl">
  @if (
    host.activeModal() === 'create' ||
    host.activeModal() === 'edit'
  ) {
    <form
      class="space-y-4"
      [formGroup]="host.roleForm"
      (ngSubmit)="host.saveRole()"
    >
      <div class="app-modal-header">
        <h3 class="app-modal-title">
          {{
            host.activeModal() === 'create'
              ? 'Create Role'
              : 'Edit Role'
          }}
        </h3>
        <button
          class="app-modal-close"
          type="button"
          aria-label="Close dialog"
          (click)="onClose()"
        >
          <span
            class="icon-[heroicons--x-mark] size-5"
          ></span>
        </button>
      </div>
      <div class="gap-4 grid">
        <div>
          <label
            class="mb-1 text-sm font-medium text-gray-700 dark:text-gray-300 block"
          >
            Name
          </label>
          <input
            class="rounded-lg border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 dark:border-gray-700 dark:bg-gray-800 dark:text-white w-full border"
            formControlName="name"
            type="text"
          />
        </div>
        <div>
          <label
            class="mb-1 text-sm font-medium text-gray-700 dark:text-gray-300 block"
          >
            Description
          </label>
          <input
            class="rounded-lg border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 dark:border-gray-700 dark:bg-gray-800 dark:text-white w-full border"
            formControlName="description"
            type="text"
          />
        </div>
        <div>
          <p
            class="mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"
          >
            Permissions
          </p>
          <div class="gap-2 sm:grid-cols-2 grid">
            @for (
              permission of host.permissions();
              track permission.id
            ) {
              <label
                class="inline-flex items-center gap-2 rounded-lg border border-slate-600/70 bg-slate-800/45 px-3 py-2 text-sm text-slate-100 transition hover:bg-slate-700/55"
              >
                <input
                  class="size-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"
                  type="checkbox"
                  [checked]="
                    host.isPermissionSelected(permission.id)
                  "
                  (change)="
                    host.togglePermission(
                      permission.id,
                      $event
                    )
                  "
                />
                <span>{{ permission.code }}</span>
              </label>
            }
          </div>
        </div>
      </div>
      <div class="gap-2 flex justify-end">
        <button
          class="app-btn-secondary"
          type="button"
          (click)="onClose()"
        >
          Cancel
          <span class="app-kbd">ESC</span>
        </button>
        <button
          class="app-btn-primary"
          type="submit"
          [disabled]="host.isSaving()"
        >
          {{ host.isSaving() ? 'Saving...' : 'Save' }}
          @if (!host.isSaving()) {
            <span class="app-kbd">ENTER</span>
          }
        </button>
      </div>
    </form>
  }

  @if (
    host.activeModal() === 'delete' &&
    host.selectedRole()
  ) {
    <div class="space-y-4">
      <div class="app-modal-header">
        <h3 class="app-modal-title">
          Delete role "{{ host.selectedRole()!.name }}"?
        </h3>
        <button
          class="app-modal-close"
          type="button"
          aria-label="Close dialog"
          (click)="onClose()"
        >
          <span
            class="icon-[heroicons--x-mark] size-5"
          ></span>
        </button>
      </div>
      <p
        class="text-sm text-gray-600 dark:text-gray-400"
      >
        This role will be permanently removed.
      </p>
      <div class="gap-2 flex justify-end">
        <button
          class="app-btn-secondary"
          type="button"
          (click)="onClose()"
        >
          Cancel
          <span class="app-kbd">ESC</span>
        </button>
        <button
          class="app-btn-danger"
          type="button"
          [disabled]="host.isDeleting()"
          (click)="host.deleteRole()"
        >
          {{
            host.isDeleting()
              ? 'Deleting...'
              : 'Delete Role'
          }}
          @if (!host.isDeleting()) {
            <span class="app-kbd">ENTER</span>
          }
        </button>
      </div>
    </div>
  }
</div>
